#!/usr/bin/env node --use_strict

/*
 * Generate a unicode debug locale and a flipped rtl
 * debug locale using podebug.
 *
 * podebug is a dependency you can install it with:

 * OSX:
 *   brew install translate-toolkit
 * Debian Linux variants:
 *   sudo apt-get install translate-toolkit
 *
 */

const glob = require('glob');
const path = require('path');
const shell = require('shelljs');

const debugLocales = ['dbl', 'dbr'];
const localeDir = path.join(__dirname, '../locale');
const templateDir = path.join(localeDir, 'templates/LC_MESSAGES');
const potFiles = glob.sync(`${templateDir}/*.pot`);

let locale;
let rewrite;
let potFile;
let poFile;
let fileName;

for (locale of debugLocales) {
  for (potFile of potFiles) {
    fileName = path.basename(potFile, '.pot');
    poFile = path.join(localeDir, locale, 'LC_MESSAGES', `${fileName}.po`);
    rewrite = locale === 'dbl' ? 'unicode' : 'flipped';
    shell.exec(`podebug -i ${potFile} -o ${poFile} --rewrite ${rewrite}`);
  }
}
